<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bayesian Inference for Inverse Problems &mdash; AlTar 2.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Installation Guide" href="Installation.html" />
    <link rel="prev" title="AlTar 2.0 Release" href="../README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> AlTar
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="Preface.html">Preface</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../README.html">AlTar 2.0 Release</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Bayesian Inference for Inverse Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inverse-problem">Inverse problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bayesian-approach">Bayesian approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="#catpmip-algorithm">CATPMIP algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Manual.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Programming.html">Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Issues.html">Common Issues</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AlTar</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="Preface.html">Preface</a> &raquo;</li>
      <li>Bayesian Inference for Inverse Problems</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cuda/Background.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="bayesian-inference-for-inverse-problems">
<span id="background"></span><h1>Bayesian Inference for Inverse Problems<a class="headerlink" href="#bayesian-inference-for-inverse-problems" title="Permalink to this headline"></a></h1>
<section id="inverse-problem">
<h2>Inverse problem<a class="headerlink" href="#inverse-problem" title="Permalink to this headline"></a></h2>
<p>An inverse problem in science is to infer a set of unknown parameters, <span class="math notranslate nohighlight">\({\boldsymbol \theta} = \{ \theta_1, \theta_2, \ldots, \theta_m \}\)</span>, from data observations <span class="math notranslate nohighlight">\({\bf d}=\{d_1, d_2, \ldots, d_n\}\)</span>. For example, in Seismology,  we deduce the earthquake rupture information (parameterized as <span class="math notranslate nohighlight">\({\boldsymbol \theta}\)</span>) from ground motions (<span class="math notranslate nohighlight">\({\bf d}\)</span>) measured by seismometers, GPS, InSAR and other geodetic surveys.  In most cases, the forward problem <span class="math notranslate nohighlight">\({\bf d} = G({\boldsymbol \theta})\)</span> is well defined but the inverse <span class="math notranslate nohighlight">\({\boldsymbol \theta} = G^{-1}({\bf d})\)</span> is not.  This happens to linear systems <span class="math notranslate nohighlight">\(G({\boldsymbol \theta})= {\bf G} {\boldsymbol \theta}\)</span> when the observation matrix <span class="math notranslate nohighlight">\({\bf G}\)</span> is ill-posed, and nonlinear systems where the inverse is inherently difficult.</p>
</section>
<section id="bayesian-approach">
<h2>Bayesian approach<a class="headerlink" href="#bayesian-approach" title="Permalink to this headline"></a></h2>
<p>Bayesian inference offers a statistical solution to inverse problems by modeling unknown parameters <span class="math notranslate nohighlight">\({\boldsymbol \theta}\)</span> as random variables subject to a conditional probability <span class="math notranslate nohighlight">\(P({\boldsymbol \theta}|{\bf d})\)</span>. According to Bayes’ theorem, the probability is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}P({\boldsymbol \theta}|{\bf d}) &amp;=  \frac {P({\boldsymbol \theta}) P({\bf d}|{\boldsymbol \theta})} {P({\bf d})}, \\
P({\boldsymbol \theta}|{\bf d}) &amp;:  \text{posterior, the probability of observing ${\boldsymbol \theta}$ given that ${\bf d}$ is true},  \\
 P({\boldsymbol \theta}) &amp;: \text{prior, the probability of observing ${\boldsymbol \theta}$ without regard to ${\bf d}$}, \nonumber \\
P({\bf d}|{\boldsymbol \theta}) &amp;:  \text{likelihood, the probability of observing ${\bf d}$ given that ${\boldsymbol \theta}$ is true},  \nonumber \\
P({\bf d}) &amp;: \text{the probability of observing } {\bf d} \text{ independent of } {\boldsymbol \theta}.\end{split}\]</div>
<p>Since <span class="math notranslate nohighlight">\(P({\bf d})\)</span> is the same for all possible <span class="math notranslate nohighlight">\({\boldsymbol \theta}\)</span> and we treat it as a constant 1. The likelihood <span class="math notranslate nohighlight">\(P({\bf d}|{\boldsymbol \theta})\)</span> can be determined from the forward modeling, for example, assuming a form of Gaussian probability density,</p>
<div class="math notranslate nohighlight">
\[P({\bf d}| {\boldsymbol \theta}) \propto  e^{-\frac {1}{2} [ {\bf d} - G({\boldsymbol \theta}) ]^T C_{\chi}^{-1} [ {\bf d} - G({\boldsymbol \theta}) ]},\]</div>
<p>where the covariance matrix <span class="math notranslate nohighlight">\(C_{\chi}\)</span> captures noises/errors in observations <span class="math notranslate nohighlight">\({\bf d}\)</span>, as well as uncertainties in the forward function <span class="math notranslate nohighlight">\(G({\boldsymbol \theta})\)</span>.</p>
<p>The set of model parameters <span class="math notranslate nohighlight">\({\boldsymbol \theta}\)</span> with the maximum posterior probability (MAP), or the mean or median model, provides an estimate solution to the inverse problem. Compared to other point estimators, the Bayesian approach has several advantages. By fully evaluating the posterior probability densities, the Bayesian approach can also address situations when several sets of <span class="math notranslate nohighlight">\({\boldsymbol \theta}\)</span> have equal or comparable probabilities, or the posterior distribution is not unimodal. In addition, the Bayesian approach accommodates uncertainty quantification, by including various types of uncertainties in the calculation.</p>
<p>The Bayesian approach is extremely intensive computationally, since it requires repeating the forward modeling for all possible <span class="math notranslate nohighlight">\({\boldsymbol \theta}\)</span>. With the improved sampling algorithms and computing powers, e.g., GPU, it now becomes feasible for many inverse problems with high dimensional parameter space and/or complex forward models.</p>
</section>
<section id="catpmip-algorithm">
<span id="catmip"></span><h2>CATPMIP algorithm<a class="headerlink" href="#catpmip-algorithm" title="Permalink to this headline"></a></h2>
<p>The posterior distribution <span class="math notranslate nohighlight">\(P({\boldsymbol \theta}|{\bf d})\)</span> can be determined, for example, by evaluating <span class="math notranslate nohighlight">\(P({\boldsymbol \theta}) P({\bf d}|{\boldsymbol \theta})\)</span> for all possible <span class="math notranslate nohighlight">\({\boldsymbol \theta}\)</span>. Instead of uniformly sampling over the entire <span class="math notranslate nohighlight">\({\bf \theta}\)</span>-space, we rely on Markov-Chain Monte-Carlo (MCMC) methods, which draw efficiently <em>weighted</em> samples pursuant to a prescribed probability distribution.</p>
<p>The CATMIP (Cascading Adaptive Transitional Metropolis in Parallel) algorithm belongs to a class of MCMC methods which use transitioning: samples are initially drawn from the prior distribution and subsequently <em>annealed</em> to the posterior through a series of transient distributions,</p>
<div class="math notranslate nohighlight">
\[P_m({\boldsymbol \theta}|{\bf d}) = P({\boldsymbol \theta}) P({\bf d}|{\boldsymbol \theta})^{\beta_m},\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta_m\)</span> (in analogy to the inverse of temperature in statistical physics) is gradually increased from <span class="math notranslate nohighlight">\(\beta_0=0\)</span> to <span class="math notranslate nohighlight">\(\beta_M=1\)</span> in <span class="math notranslate nohighlight">\(M\)</span> steps.</p>
<p>The procedure of CATMIP is described as follows:</p>
<ol class="arabic simple">
<li><p>For the <span class="math notranslate nohighlight">\(m=0\)</span> <span class="math notranslate nohighlight">\(\beta\)</span>-step, with <span class="math notranslate nohighlight">\(\beta_0=0\)</span>, generate <span class="math notranslate nohighlight">\(N_s\)</span> random samples from the distribution <span class="math notranslate nohighlight">\(P_0 ({\boldsymbol \theta}|{\bf d}) = P({\boldsymbol \theta})\)</span>, as seeds of <span class="math notranslate nohighlight">\(N_s\)</span> parallel chains.</p></li>
<li><p>Determine <span class="math notranslate nohighlight">\(\beta_{m+1}\)</span> for the next <span class="math notranslate nohighlight">\(\beta\)</span>-step, e.g., from the statistics of the samples from the <span class="math notranslate nohighlight">\(\beta_m\)</span>-step. CATMIP uses an annealing schedule based on the coefficient of variance (COV) of the importance weights <span class="math notranslate nohighlight">\(w_i = P({\bf d}|{\boldsymbol \theta}_i)^{\beta_{m+1}-\beta_m}\)</span>. The targeted COV is typically set as 1, or the effective sample size (ESS) equals to 50%.</p></li>
<li><p>Perform a resampling of samples based on their importance weights <span class="math notranslate nohighlight">\(\{w_i\}\)</span>: some samples with small weights may be discarded while some samples with large weights are duplicated. The total number of samples is kept the same, as seeds for <span class="math notranslate nohighlight">\(N_s\)</span> chains in the <span class="math notranslate nohighlight">\(\beta_{m+1}\)</span>-step.</p></li>
<li><p>With the new <span class="math notranslate nohighlight">\(\beta_{m+1}\)</span>, a burn-in MCMC process is preformed with the Metropolis-Hastings algorithm. New samples are proposed from the distribution <span class="math notranslate nohighlight">\(P_{m}  ({\boldsymbol \theta}|{\bf d})\)</span>, assuming a multivariate Gaussian form, and accepted/rejected subject to the probability density <span class="math notranslate nohighlight">\(P_{m+1}  ({\boldsymbol \theta}|{\bf d})\)</span>. The acceptance ratio is also recorded, which is used to scale the jump distances for proposals in the next <span class="math notranslate nohighlight">\(\beta\)</span>-step.</p></li>
<li><p>Repeat Steps 2-4 until <span class="math notranslate nohighlight">\(\beta_{M}=1\)</span> is reached, or the desired equilibrium distribution <span class="math notranslate nohighlight">\(P ({\boldsymbol \theta}|{\bf d})\)</span> is achieved.</p></li>
</ol>
<p>Step 4 presents the majority of the computational load. Since each chain is updated independently, the computation is embarrassingly parallel, which makes CATMIP an ideal algorithm to be implemented on parallel computers, including GPUs.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline"></a></h2>
<ol class="arabic simple">
<li><p>Albert Tarantola, <em>Inverse Problem Theory and Methods for Model Parameter Estimation</em>, SIAM, 2005. ISBN: 978-0-89871-572-9.</p></li>
<li><p>Sarah E. Minson,  Mark Simons,  and James L. Beck, <em>Bayesian inversion for finite fault earthquake source models I — theory and algorithm</em>, Geophysical Journal International, Vol. 194, 1701 (2013).</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../README.html" class="btn btn-neutral float-left" title="AlTar 2.0 Release" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Installation.html" class="btn btn-neutral float-right" title="Installation Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2020 ParaSim Inc., 2010-2020 California Institute of Technology..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>